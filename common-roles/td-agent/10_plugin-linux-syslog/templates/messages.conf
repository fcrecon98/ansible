<source>
    type tail
    format /^(?<message>.+)$/
    path /var/log/messages
    pos_file /var/log/td-agent/pos/messages
    tag linux.syslog.messages.{{ ansible_hostname }}
</source>

<match linux.syslog.messages.*>
    type forward
    buffer_type file
    buffer_path /tmp/td-agent/buffer/messages
    flush_interval 1s
    buffer_chunk_limit 8M
    retry_limit 9
    <server>
      host {{ logserver }}
    </server>
    <secondary>
      type file
      path /var/log/td-agent/err/messages
      time_slice_format %Y%m%d
    </secondary>
</match>
